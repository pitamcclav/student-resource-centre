(()=>{var e={};e.id=501,e.ids=[501],e.modules={6330:e=>{"use strict";e.exports=require("@prisma/client")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},4573:e=>{"use strict";e.exports=require("node:buffer")},7598:e=>{"use strict";e.exports=require("node:crypto")},7975:e=>{"use strict";e.exports=require("node:util")},6026:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>l});var s=t(260),a=t(8203),n=t(5155),i=t.n(n),o=t(7292),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);t.d(r,d);let l=["",{children:["auth",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4062)),"C:\\Users\\HP\\Desktop\\Projects\\student-resource-centre\\src\\app\\auth\\admin\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,1354)),"C:\\Users\\HP\\Desktop\\Projects\\student-resource-centre\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9937,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\HP\\Desktop\\Projects\\student-resource-centre\\src\\app\\auth\\admin\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/auth/admin/page",pathname:"/auth/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},6861:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"40eda817ae00ac3aab4ccfc4ae8b80cb4ab74e7791":()=>l});var s=t(1590);t(376);var a=t(6500),n=t(2385),i=t(3808),o=t(9344);let d=a.z.object({email:a.z.string().email("Invalid email address"),password:a.z.string().min(6,"Password must be at least 6 characters")});async function l(e){console.log("validating");let r=d.safeParse({email:e.get("email"),password:e.get("password")});if(!r.success)return{error:r.error.flatten().fieldErrors};console.log("done validation");try{let e=await (0,i.bS)(r.data.email,r.data.password);return(await (0,n.UL)()).set("session",e.token,{httpOnly:!0,secure:!0,sameSite:"strict",maxAge:604800}),{success:!0}}catch(e){return{error:{general:e.message||"Invalid email or password"}}}}(0,o.D)([l]),(0,s.A)(l,"40eda817ae00ac3aab4ccfc4ae8b80cb4ab74e7791",null)},7804:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,3219,23)),Promise.resolve().then(t.t.bind(t,4863,23)),Promise.resolve().then(t.t.bind(t,5155,23)),Promise.resolve().then(t.t.bind(t,9350,23)),Promise.resolve().then(t.t.bind(t,6313,23)),Promise.resolve().then(t.t.bind(t,8530,23)),Promise.resolve().then(t.t.bind(t,8921,23))},1356:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,6959,23)),Promise.resolve().then(t.t.bind(t,3875,23)),Promise.resolve().then(t.t.bind(t,8903,23)),Promise.resolve().then(t.t.bind(t,4178,23)),Promise.resolve().then(t.t.bind(t,6013,23)),Promise.resolve().then(t.t.bind(t,7190,23)),Promise.resolve().then(t.t.bind(t,1365,23))},1367:()=>{},5279:()=>{},6094:(e,r,t)=>{Promise.resolve().then(t.bind(t,4062))},9142:(e,r,t)=>{Promise.resolve().then(t.bind(t,5236))},5236:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(5512),a=t(7722),n=t(2405),i=t(6953),o=t(8009),d=t(6248);let l=(0,d.createServerReference)("40eda817ae00ac3aab4ccfc4ae8b80cb4ab74e7791",d.callServer,void 0,d.findSourceMapURL,"loginAdmin");function c(){let[e,r]=(0,o.useState)(null),t=(0,i.useRouter)();async function d(e){e.preventDefault();let s=new FormData(e.currentTarget);console.log("form data entries:",Array.from(s.entries()));let a=await l(s);a.success?t.push("/admin/dashboard"):r(a.error?.general||"Login failed")}return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,s.jsxs)("div",{className:"w-full max-w-md p-8 space-y-8 bg-white rounded-lg shadow-md",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-900",children:"Admin Login"}),e&&(0,s.jsx)("div",{className:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg",role:"alert",children:e}),(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:d,children:[(0,s.jsxs)("div",{className:"rounded-md shadow-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(n.Label,{htmlFor:"email",className:"sr-only",children:"Email address"}),(0,s.jsx)(a.p,{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"relative block w-full px-3 py-2 border border-gray-300 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Email address"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(n.Label,{htmlFor:"password",className:"sr-only",children:"Password"}),(0,s.jsx)(a.p,{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"relative block w-full px-3 my-5 py-2 border border-gray-300 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Password"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,s.jsx)(n.Label,{htmlFor:"remember-me",className:"ml-2 text-sm text-gray-900",children:"Remember me"})]}),(0,s.jsx)("div",{className:"text-sm",children:(0,s.jsx)("a",{href:"#",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Forgot your password?"})})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:"relative flex justify-center w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Sign in"})})]})]})})}},7722:(e,r,t)=>{"use strict";t.d(r,{p:()=>i});var s=t(5512),a=t(8009),n=t(4195);let i=a.forwardRef(({className:e,type:r,...t},a)=>(0,s.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...t}));i.displayName="Input"},4195:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var s=t(2281),a=t(4805);function n(...e){return(0,a.QP)((0,s.$)(e))}},4062:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\HP\\\\Desktop\\\\Projects\\\\student-resource-centre\\\\src\\\\app\\\\auth\\\\admin\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\HP\\Desktop\\Projects\\student-resource-centre\\src\\app\\auth\\admin\\page.tsx","default")},1354:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l,metadata:()=>d});var s=t(2740),a=t(6381),n=t.n(a),i=t(3704),o=t.n(i);t(1135);let d={title:"Create Next App",description:"Generated by create next app"};function l({children:e}){return(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{className:`${n().variable} ${o().variable} antialiased`,children:(0,s.jsx)("main",{children:e})})})}},3808:(e,r,t)=>{"use strict";t.d(r,{bS:()=>u,$u:()=>c,Rr:()=>l});var s=t(784);t(2385);let a=require("bcrypt");var n=t.n(a);let i=new(t(6330)).PrismaClient,o=new TextEncoder().encode(process.env.JWT_SECRET);async function d(e){return await new s.P(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("1h").sign(o)}async function l(e,r,t,s){try{let a=await i.student.findFirst({where:{OR:[{studentNo:e},{email:r}]}});if(console.log("trying to get user"),a)return{errors:{general:a.studentNo===e?"Student number is already registered":"Email is already in use"},console:a.studentNo===e};let o=await i.program.findFirst({where:{id:s}});if(!o)return{errorType:"validation",errors:{programId:"Invalid program selected"},console:"Invalid program selected"};console.log("found program:",o),console.log(s),console.log(e),console.log(r);let l=await n().hash(t,10);console.log("hashed");let c=await i.student.create({data:{studentNo:e,email:r,password:l,program:{connect:{id:s}}}});console.log("new student saved:",c);let u=await d({id:c.id,studentNo:c.studentNo});return{success:!0,token:u}}catch(e){return console.error("Registration error:",e),{errors:{general:"Registration failed. Please try again."}}}}async function c(e,r){let t=await i.student.findFirst({where:{studentNo:e}});if(!t)throw Error("User not found");if(!await n().compare(r,t.password))throw Error("Invalid credentials");return{token:await d({id:t.id,studentNo:t.studentNo}),student:t}}async function u(e,r){console.log("authenticating admin");let t=await i.admin.findFirst({where:{email:e}});if(!t)throw Error("User not found");if(!await n().compare(r,t.password))throw Error("Invalid credentials");return{token:await d({id:t.id,email:t.email}),admin:t}}},440:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var s=t(8077);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},1135:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[989,735,66,10,635,333],()=>t(6026));module.exports=s})();